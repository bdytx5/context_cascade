from transformers import AutoModel, AutoTokenizer

model_name = 'liufanfanlff/C3-Context-Cascade-Compression'
tokenizer = AutoTokenizer.from_pretrained(model_name, trust_remote_code=True)
model = AutoModel.from_pretrained(model_name , trust_remote_code=True, low_cpu_mem_usage=True, device_map='cuda', use_safetensors=True, pad_token_id=tokenizer.eos_token_id)
model = model.eval().cuda()
prompt = 'Repeat the text: '
# context = "帝高阳之苗裔兮，朕皇考曰伯庸。摄提贞于孟陬兮，"
context = "Curriculum Unit 93.02.12 6 of 14 Many an honest man who wanted to marry her. She insisted that she deserved no less than a prince. The years passed by and her beauty was fading when a very handsome suitor swept her off her feet. She knew her prince had finally come. She fell madly in love with him. The man asked her parents for her hand in marriage and they were engaged. Rosamada, that was her name, was the happiest woman in the world. They were married in a fabulous wedding, the groom was more handsome than ever in his high hat and tuxedo. A reception followed with plenty to eat and drink. She looked beautiful in her lace wedding gown, her veil, and flower crown. After the reception, the newlyweds went on their honeymoon. When they arrived at a castle in the forest that the groom had chosen, she embraced and smiled at her husband lovingly. He returned the smile and she noticed that his teeth were very long, sharp, and shone like gold. Rosamada was quite surprised; she had not noticed that his teeth were like this before. Her husband then took off his coat and then she saw that he had a two-pointed tail. She started to tremble with horror. What was happening? She had married a very handsome young man, who was this person? Her husband very abruptly took off his hat and the new wife almost fainted. The man had two horns and two very big and pointed ears. He then took off his shirt and she saw that his chest was covered with long black hairs. When he started taking off his gloves, Rosamada tried to escape from his sight but he caught her with his hairy arms and very long claws. He held her while he took off his shoes and she was able to see that his feet were hoofs. She started to scream for help but no one could hear her. She understood at once that she had married the devil himself, and that she was being punished for her arrogance. They say that the devil and the castle disappeared all at once. By pure luck, a hunter found Rosamada lying on the ground and took her back to the city. She was sick six months with hot and cold chills and then she died, which always happens. FOLKTALE J. Alden Mason and Aurelio M. Espinosa found three versions of the El Medio Pollito story that were being told in Puerto Rico in the beginning of this century. These versions were European and probably were brought to the island from Castile. R. S. Boggs in his article “The Halfchick Tale in Spain and France” summarizes the story as it was basically being told in Puerto Rico, but also found a literary version that was being used in schools in the United States. The story is retold in The Green Fairy Book by Andrew Lang from Fernan Caballero. The version that I have translated seems to be closer to this version than to the original Castilian story. Apparently this version was introduced in Puerto Rico after the island became a possession of the United States in 1898. Marigloria Palma in her book Muestras del Folklore Puertorriqueño (in Spanish) tells the story as she heard it as a child. I have translated her version of the story and illustrated the story as I see it. Summary Half-a-chick decides to travel to the capital to find a doctor to repair or add his missing half. He has one leg, one eye, and one wing but believes he is better than everyone in the chicken coop and cannot stand being there anymore. Before leaving, his mother gives him advice which he does not follow. On his way to the capital he refuses to help river, wind, and fire. When he finally arrives at the big city, he confuses the king and queen with the cooks of the palace. He is overcooked and thrown out of the kitchen window. The wind picks him and takes him high in the air and puts him on top of the cathedral where he becomes a weathercock at"
outputs = model.chat(tokenizer, context, prompt)
print ("Repeat the text: ",outputs)

